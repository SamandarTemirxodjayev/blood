
// console.log("Bot is starting...");
// const TelegramBot = require("node-telegram-bot-api");
// const axios = require("axios");
// const token = process.env.BOOLD_BOT_TOKEN;
// const bot = new TelegramBot(token, { polling: true });
// const API_BASE_URL = process.env.API_URL;

// async function fetchNewsFromApi() {
//   try {
//     const response = await axios.get(`${API_BASE_URL}/news`);
//     return response.data;
//   } catch (error) {
//     console.error("Error fetching news from API:", error);
//     throw error;
//   }
// }

// async function fetchClinicsFromApi() {
//   try {
//     const response = await axios.get(`${API_BASE_URL}/clinics`);
//     return response.data;
//   } catch (error) {
//     console.error("Error fetching news from API:", error);
//     throw error;
//   }
// }

// async function fetchDoctorsFromApi() {
//   try {
//     const response = await axios.get(`${API_BASE_URL}/doctors`);
//     return response.data;
//   } catch (error) {
//     console.error("Error fetching news from API:", error);
//     throw error;
//   }
// }

// async function fetchAnalysisFromApi() {
//   try {
//     const response = await axios.get(`${API_BASE_URL}/analysis`);
//     return response.data;
//   } catch (error) {
//     console.error("Error fetching analysis from API:", error);
//     throw error;
//   }
// }

// bot.onText(/\/start/, async (msg) => {
//   const chatId = msg.chat.id;
//   try {
//     const name = msg.chat.first_name;
//     const options = {
//       parse_mode: "HTML",
//       reply_markup: {
//         keyboard: [
//           ["Analysis", "Doctors"],
//           ["Clinics", "News"],
//         ],
//         resize_keyboard: true,
//         one_time_keyboard: true,
//       },
//     };
//     bot.sendMessage(chatId, `<b>${name}</b>, welcome to the bot! Please select an option from the main menu:`, options);
//   } catch (error) {
//     console.error("Error sending message:", error);
//     bot.sendMessage(chatId, "Error sending message. Please try again later.");
//   }
// });

// bot.onText(/analysis/, async (msg) => {
//   const chatId = msg.chat.id;
//   try {
//     await bot.sendMessage(
//       chatId,
//       "Please share your contact to retrieve the analysis data.",
//       {
//         reply_markup: {
//           keyboard: [[{ text: "Share Contact", request_contact: true }]],
//           resize_keyboard: true,
//           one_time_keyboard: true,
//         },
//       }
//     );
//   } catch (error) {
//     console.error("Error sending message:", error);
//     bot.sendMessage(chatId, "Error occurred. Please try again later.");
//   }
// });

// bot.on("contact", async (msg) => {
//   const chatId = msg.chat.id;
//   const userPhoneNumber = msg.contact.phone_number;
//   try {
//     const analysisResponse = await fetchAnalysisFromApi();
//     const analysisData = analysisResponse.data;
//     const matchedAnalysis = analysisData.find(
//       (item) => item.number === parseInt(userPhoneNumber)
//     );
//     if (matchedAnalysis) {
//       await sendMatchedAnalysis(chatId, matchedAnalysis);
//       await sendMainMenu(chatId);
//     } else {
//       await bot.sendMessage(
//         chatId,
//         "No matching analysis found for your phone number."
//       );
//       await sendMainMenu(chatId);
//     }
//   } catch (error) {
//     console.error("Error fetching analysis:", error);
//     bot.sendMessage(chatId, "Error fetching analysis. Please try again later.");
//   }
// });

// async function sendMainMenu(chatId) {
//   try {
//     await bot.sendMessage(chatId, "Main Menu", {
//       reply_markup: {
//         keyboard: [[{ text: "analysis" }]],
//         resize_keyboard: true,
//         one_time_keyboard: true,
//       },
//     });
//   } catch (error) {
//     console.error("Error sending main menu:", error);
//     bot.sendMessage(chatId, "Error sending main menu. Please try again later.");
//   }
// }

// async function sendMatchedAnalysis(chatId, analysis) {
//   try {
//     const analysisMessage = `<b>${analysis.name}</b>\n${analysis.number}\n${analysis.fileUrl}\n`;
//     const options = {
//       parse_mode: "HTML",
//     };
//     await bot.sendMessage(chatId, analysisMessage, options);
//   } catch (error) {
//     console.error("Error sending matched analysis:", error);
//     bot.sendMessage(chatId, "Error sending analysis. Please try again later.");
//   }
// }

// bot.onText(/clinics/, async (msg) => {
//   const chatId = msg.chat.id;
//   try {
//     const clinicsResponse = await fetchClinicsFromApi();
//     const clinics = clinicsResponse.data;
//     await sendClinics(chatId, clinics);
//   } catch (error) {
//     console.error("Error fetching clinics:", error);
//     bot.sendMessage(chatId, "Error fetching clinics. Please try again later.");
//   }
// });

// async function sendClinics(chatId, clinics) {
//   try {
//     const clinicsMessage = clinics
//       .map((clinic, index) => {
//         return `<b>${index + 1}. ${clinic.name}</b>\n${clinic.location}\n\n`;
//       })
//       .join("\n");
//     await bot.sendMessage(chatId, clinicsMessage, { parse_mode: "HTML" });
//   } catch (error) {
//     console.error("Error sending clinics:", error);
//     bot.sendMessage(chatId, "Error sending clinics. Please try again later.");
//   }
// }

// let currentDoctorsIndex = 0;
// bot.onText(/doctors/, async (msg) => {
//   const chatId = msg.chat.id;
//   try {
//     const doctorsResponse = await fetchDoctorsFromApi();
//     const doctors = doctorsResponse.data;
//     await sendDoctors(chatId, doctors[currentDoctorsIndex]);
//   } catch (error) {
//     console.error("Error fetching doctors:", error);
//     bot.sendMessage(chatId, "Error fetching doctors. Please try again later.");
//   }
// });

// bot.onText(/\/docNext/, async (msg) => {
//   const chatId = msg.chat.id;
//   try {
//     const doctorsResponse = await fetchDoctorsFromApi();
//     const doctors = doctorsResponse.data;
//     if (currentDoctorsIndex + 1 < doctors.length) {
//       currentDoctorsIndex++;
//       await sendDoctors(chatId, doctors[currentDoctorsIndex]);
//     } else {
//       bot.sendMessage(chatId, "No more doctors available.");
//     }
//   } catch (error) {
//     console.error("Error fetching doctors:", error);
//     bot.sendMessage(chatId, "Error fetching doctors. Please try again later.");
//   }
// });

// async function sendDoctors(chatId, doctorsItem) {
//   const doctorsMessage = `
//     <b>${doctorsItem.name}</b>\n
//     ${doctorsItem.work}
//   `;
//   try {
//     await bot.sendMessage(chatId, doctorsMessage, { parse_mode: "HTML" });
//   } catch (error) {
//     console.error("Error sending doctors:", error);
//     bot.sendMessage(chatId, "Error sending doctors. Please try again later.");
//   }
// }

// let currentNewsIndex = 0;
// bot.onText(/news/, async (msg) => {
//   const chatId = msg.chat.id;
//   try {
//     const newsResponse = await fetchNewsFromApi();
//     const news = newsResponse.data;
//     await sendNews(chatId, news[currentNewsIndex]);
//     return;
//   } catch (error) {
//     console.error("Error fetching news:", error);
//     bot.sendMessage(chatId, "Error fetching news. Please try again later.");
//   }
// });

// bot.onText(/\/newsNext/, async (msg) => {
//   const chatId = msg.chat.id;
//   try {
//     const newsResponse = await fetchNewsFromApi();
//     const news = newsResponse.data;
//     if (currentNewsIndex + 1 < news.length) {
//       currentNewsIndex++;
//       await sendNews(chatId, news[currentNewsIndex]);
//     } else {
//       bot.sendMessage(chatId, "No more news available.");
//     }
//   } catch (error) {
//     console.error("Error fetching news:", error);
//     bot.sendMessage(chatId, "Error fetching news. Please try again later.");
//   }
// });

// async function sendNews(chatId, newsItem) {
//   const newsMessage = `
//     <b>${newsItem.title}</b>\n
//     ${newsItem.description}
//   `;
//   try {
//     const imageUrl = `${newsItem.image[0].filename}`;
//     await bot.sendPhoto(chatId, process.cwd() + "/uploads/" + imageUrl, {
//       caption: newsMessage,
//       parse_mode: "HTML",
//     });
//   } catch (error) {
//     console.error("Error sending news:", error);
//     bot.sendMessage(chatId, "Error sending news. Please try again later.");
//   }
// }
